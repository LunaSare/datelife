---
title: "Getting started with `datelife`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting started with `datelife`}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(datelife)
```

## What can you do with `datelife`?

The aim of the `datelife` R package is to allow researchers and the general audience to obtain data on ages for their organisms of interest. This age data is extracted from dated phylogenetic trees (chronograms) that have been published and peer-reviewed in association with a scientific article in an indexed journal. As such, the age data provided by `datelife` constitutes state-of-the-art, peer-reviewed, public scientific knowledge, that can be accessed by experts and non-experts in the field alike. 

Users can get age data for their organisms of interest in several forms:

- *MRCA*: They can get the age of the most recent common ancestor (MRCA) of their organisms.

- *Original chronogram*: They can get the chronograms from the original publications, pruned to contain their organisms only.

- *Biggest chronogram*: They can get the original chronogram with the most organisms of interest present as tips.

- *Summary chronogram*: They can obtain a single chronogram, summarized using data from the original chronograms. The summary chronogram can be calculated using different methods.

Users can also apply the obtained age data to date a phylogenetic tree topology of their organisms of interest.

## 1. Preparing your organism names

The function `make_datelife_query` processes the scientific names of your organisms of interest and saves them as a `datelifeQuery` object.
This allows you to easily use them later to perform a search for ages across the `datelife` chronogram database. You have two general ways of providing organism names:

### a) From a set of organism names
You can provide the scientific names as a character vector or as a single comma separated string of names.
For example, running the following:

```{r}

datelife::make_datelife_query(input = c("Delphinus_delphus", "Gallus gallus", "elephas Maximus", "felis_catus"))
```

Gives the same result as running:

```{r}

datelife::make_datelife_query(input = "Delphinus_delphus, Gallus gallus, elephas Maximus, felis_catus")
```

Note that you can use underscores or spaces to separate binomial scientific names and `datelife` will process them.

### b) From a tree with organism names on its tips

You can also provide the scientific names of your organisms of interest as labels on the tips of any phylogenetic tree.
You can provide the tree as a newick string:

```{r}
newick <- "((Elephas_maximus,(Delphinus_delphus, Felis_silvestris)), Gallus_gallus);"
datelife::make_datelife_query(input = newick)
```

You can also provide the tree as a phylo object:

```{r}
phylo <- ape::read.tree(text = newick)
datelife::make_datelife_query(input = phylo)
```

Let's save our `datelifeQuery`:

```{r}

my_datelife_query <- datelife::make_datelife_query(input = phylo)

```

## 2. Searching the chronogram database

The `datelife_search` function takes a `datelifeQuery` object and goes through the `datelife` chronogram database to find all chronograms matching at least two organism names. 

```{r}

datelife::datelife_search(input = my_datelife_query)
```

The function will also summarize the results from the search for you.
By default, it will get all original chronograms matching the search. You can specify the output with the argument `summary_format`.
There are different summary outputs to choose from:

- `"citations"`

- `"mrca"`

- `"newick_all"`

- `"newick_sdm"`

- `"newick_median"`

- `"phylo_sdm"`

- `"phylo_median"`

- `"phylo_all"`

- `"phylo_biggest"`

- `"html"`

- `"data_frame"`







